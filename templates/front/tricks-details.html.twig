{% extends 'base.html.twig' %}

{% block body %}
    <main id="main">

        <!-- ======= Breadcrumbs Section ======= -->
        <section class="breadcrumbs">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="d-flex flex-column align-items-start">
                        <h2>{{ trick.title }} <a href="{{ path('edit_trick', {'id': trick.id}) }}"
                                                class="trick-link col-2"><i class="fa fa-edit"></i></a></h2>
                        <blockquote class="blockquote-footer">Créé
                            par {{ trick.user.username~ " le " ~trick.createdAt | date('d/m/Y à H:i') }}</blockquote>
                    </div>
                    <ol>
                        <li><a href="/">Home</a></li>
                        <li><a href="{{ path('home', {'_fragment': 'tricks'}) }}">Tricks</a></li>
                        <li>{{ trick.title | slice(0, 15) }}...</li>
                    </ol>
                </div>
            </div>
        </section><!-- Breadcrumbs Section -->

        <!-- ======= Trick Details Section ======= -->
        <section class="tricks-details">
            <div class="container">
                <div class="tricks-details-container">
                    <img src="{{ asset('/img/tricks/' ~ trick.image) }}" class="img-fluid" alt="">
                    <div class="tricks-info">
                        <h3>Snow tricks informations</h3>
                        <ul>
                            <li><strong>Position</strong>: {{ trick.position }}</li>
                            <li><strong>Grabs</strong>: {{ trick.grabs }}</li>
                            <li><strong>Rotation</strong>: {{ trick.rotation }}</li>
                            <li><strong>Flip</strong>: {{ trick.flip }}</li>
                            <li><strong>Slide</strong>: {{ trick.slide }}</li>
                        </ul>
                    </div>
                </div>
                <!-- TODO: librairie des images et vidéos par trick -->
                <div class="row tricks-container" data-aos="fade-up" id="library">
                    <div class="card col-lg-3 col-md-6 tricks-item" style="flex-direction: row">
                        {% for library in itemsLibrary %}
                               {% if library.type == 1 %}
                                   <img src="{{ library.lien }}">
                               {% else %}
                                   <iframe width="290" height="217" src="{{ library.lien }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                               {% endif %}
                        {% endfor %}
                    </div>
                </div>
                <div class="tricks-description">
                    <h2>{{ trick.title }}</h2>
                    {{ trick.description | raw }}
                </div>
                <!-- ======= Trick history Section ======= -->
                <div class="tricks-description">
                    <blockquote class="blockquote-footer">Historique des contributeurs de l'article :
                        {% for trickHistory in trick.trickHistories %}
                            <ul class="list-group list-group-flush">
                                <li>{{ trickHistory.modifiedAt | date('d/m/Y à H:i')~" (contributeur : "~trickHistory.user.username }}
                                    )
                                </li>
                            </ul>
                        {% endfor %}
                    </blockquote>
                </div><!-- End Trick history Section -->
            </div>
        </section><!-- End Trick Details Section -->
        <!-- ======= Trick Comments Section ======= -->
        <section class="tricks-comments" id="tricks-comments">
            <div class="container">
                {% if not app.user %}
                    <div class="tricks-connection col-10">
                        <a href="{{ path('security_login') }}">Connectez-vous</a> ou <a
                                href="{{ path('security_registration') }}">inscrivez-vous</a> pour participer à la
                        conversation !
                    </div>
                {% else %}
                    <div class="tricks-connection col-10">
                        <!-- ==== Trick Comment Form ==== -->
                        <h3 class="login-heading mb-4">Ajouter un commentaire</h3>
                        {{ form_start(commentForm) }}
                        <div class="form-group">
                            {{ form_row(commentForm.title, {'label': 'Titre', 'attr': {'placeholder': 'Titre...', 'aria-describedby': 'basic-addon3', 'class': 'form-control'}, 'type': 'text', 'id': 'inputTitle'}) }}
                        </div>
                        <div class="form-group">
                            {{ form_row(commentForm.content, {'label': 'Contenu', 'attr': {'placeholder': 'Mon commentaire...', 'aria-describedby': 'basic-addon3', 'class': 'form-control'}, 'type': 'textarea', 'id': 'inputContent'}) }}
                        </div>
                        <button type="submit" class="btn btn-primary" style="margin-bottom: 1rem">
                            Ajouter mon commentaire
                        </button>
                        {{ form_end(commentForm) }}
                    </div>
                {% endif %}
                {% for label, messages in app.flashes %}
                    <div class="container">
                        <div class="alert alert-{{ label }} mb-0">
                            {% for message in messages %}
                                {{ message | raw }}
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
                <div class="list-group">
                    {% for comments in trick.comments %}
                        <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                            <div class="d-flex w-100 justify-content-between">
                                <h5 class="mb-1">{{ comments.title }}</h5>
                                <small class="text-muted">{{ comments.createdAt | date('d/m/Y à H:i') }}
                                    - {{ comments.user.username }} <img
                                            src="{{ asset('/img/profils/' ~ comments.user.image ~ '-thumbail.jpg') }}"></small>
                            </div>
                            <p class="mb-1">{{ comments.content | raw }}</p>
                        </a>
                    {% endfor %}
                </div>
            </div>
        </section>
        <!-- End Tricks Comments Section -->
    </main><!-- End #main -->
{% endblock %}